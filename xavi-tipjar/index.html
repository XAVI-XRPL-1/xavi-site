<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TipJar â€” On-Chain Tipping on XRPL EVM</title>
    <link rel="icon" type="image/png" href="../xavi-logo.png">
    <link rel="stylesheet" href="../xavi-design-system.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.7.0/dist/ethers.umd.min.js"></script>
    
    <style>
        .page-header {
            padding: 100px 0 40px;
            text-align: center;
        }
        
        .page-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: var(--space-md);
        }
        
        .page-desc {
            font-size: 17px;
            color: var(--xavi-muted);
            max-width: 500px;
            margin: var(--space-md) auto 0;
        }
        
        .contract-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-lg);
            margin-top: var(--space-lg);
            flex-wrap: wrap;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-xl);
            max-width: 900px;
            margin: 0 auto;
        }
        
        .tip-card {
            padding: var(--space-xl);
        }
        
        .tip-card-title {
            font-family: var(--font-display);
            font-size: 20px;
            font-weight: 600;
            margin-bottom: var(--space-lg);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .tip-form-group {
            margin-bottom: var(--space-lg);
        }
        
        .tip-form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--xavi-muted);
            margin-bottom: var(--space-sm);
        }
        
        .tip-input {
            width: 100%;
            padding: 14px 16px;
            background: var(--xavi-charcoal);
            border: 2px solid var(--xavi-border);
            border-radius: var(--radius-md);
            color: var(--xavi-white);
            font-size: 16px;
            transition: border-color var(--transition-fast);
        }
        
        .tip-input:focus {
            outline: none;
            border-color: var(--xavi-purple-mid);
        }
        
        .tip-input::placeholder {
            color: var(--xavi-dim);
        }
        
        .token-toggle {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }
        
        .token-toggle-btn {
            flex: 1;
            padding: 12px;
            background: var(--xavi-charcoal);
            border: 2px solid var(--xavi-border);
            border-radius: var(--radius-md);
            color: var(--xavi-muted);
            font-family: var(--font-display);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }
        
        .token-toggle-btn.active {
            background: var(--xavi-purple-deep);
            border-color: var(--xavi-purple-mid);
            color: var(--xavi-white);
        }
        
        .token-toggle-btn:hover:not(.active) {
            border-color: var(--xavi-purple-mid);
        }
        
        .quick-amounts {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }
        
        .quick-amount-btn {
            flex: 1;
            padding: 10px;
            background: var(--xavi-surface);
            border: 1px solid var(--xavi-border);
            border-radius: var(--radius-sm);
            color: var(--xavi-muted);
            font-size: 14px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .quick-amount-btn:hover {
            border-color: var(--xavi-gold);
            color: var(--xavi-gold);
        }
        
        /* Leaderboard */
        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--xavi-charcoal);
            border: 1px solid var(--xavi-border);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-sm);
            transition: all var(--transition-fast);
        }
        
        .leaderboard-item:hover {
            border-color: var(--xavi-purple-mid);
        }
        
        .leaderboard-rank {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-family: var(--font-display);
            font-weight: 700;
            font-size: 14px;
        }
        
        .leaderboard-rank.gold {
            background: linear-gradient(135deg, var(--xavi-gold), #C4902A);
            color: var(--xavi-black);
        }
        
        .leaderboard-rank.silver {
            background: linear-gradient(135deg, #9CA3AF, #6B7280);
            color: var(--xavi-black);
        }
        
        .leaderboard-rank.bronze {
            background: linear-gradient(135deg, #CD7F32, #A0522D);
            color: white;
        }
        
        .leaderboard-rank.default {
            background: var(--xavi-surface);
            color: var(--xavi-muted);
        }
        
        .leaderboard-info {
            flex: 1;
        }
        
        .leaderboard-address {
            font-family: var(--font-mono);
            font-size: 14px;
            color: var(--xavi-white);
        }
        
        .leaderboard-tips {
            font-size: 13px;
            color: var(--xavi-dim);
        }
        
        .leaderboard-amount {
            font-family: var(--font-display);
            font-weight: 600;
            color: var(--xavi-gold);
        }
        
        /* Stats */
        .tip-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-md);
            margin-top: var(--space-2xl);
        }
        
        .tip-stat {
            text-align: center;
            padding: var(--space-lg);
        }
        
        .tip-stat-value {
            font-family: var(--font-display);
            font-size: 24px;
            font-weight: 700;
            color: var(--xavi-white);
        }
        
        .tip-stat-label {
            font-size: 13px;
            color: var(--xavi-dim);
            margin-top: 4px;
        }
        
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .tip-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="xavi-bg"></div>
    <div class="xavi-bg-gradient"></div>
    
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-inner">
            <a href="../" class="navbar-logo">
                <i data-lucide="arrow-left" style="width: 20px; height: 20px; stroke: var(--xavi-muted);"></i>
                <img src="../xavi-logo.png" alt="Xavi">
                <span>XAVI</span>
            </a>
            <button class="btn btn-primary btn-sm" id="connectBtn" onclick="connectWallet()">
                <i data-lucide="wallet"></i>
                Connect
            </button>
        </div>
    </nav>
    
    <!-- Header -->
    <section class="page-header">
        <div class="container">
            <div class="page-badge">
                <div class="icon-box icon-box-sm">
                    <i data-lucide="coins"></i>
                </div>
                <span class="badge badge-live">Live</span>
            </div>
            <h1>TipJar</h1>
            <p class="page-desc">Send tips in XRP or RLUSD with on-chain tracking and leaderboard.</p>
            <div class="contract-bar">
                <div class="pill">
                    <span>0x0bff...Fdd4</span>
                    <i data-lucide="copy" style="width: 14px; cursor: pointer;" onclick="copyText('0x0bff02033289A9F0fAb1980a4fd6Ba723e47Fdd4')"></i>
                </div>
                <a href="https://explorer.xrplevm.org/address/0x0bff02033289A9F0fAb1980a4fd6Ba723e47Fdd4" target="_blank" class="btn btn-ghost btn-sm">
                    <i data-lucide="external-link"></i>
                    Explorer
                </a>
            </div>
        </div>
    </section>
    
    <!-- Main Content -->
    <section class="section" style="padding-top: 0;">
        <div class="container">
            <div class="main-grid">
                <!-- Send Tip -->
                <div class="xavi-card tip-card">
                    <h3 class="tip-card-title">
                        <i data-lucide="send" style="width: 20px; stroke: var(--xavi-gold);"></i>
                        Send a Tip
                    </h3>
                    
                    <div class="token-toggle">
                        <button class="token-toggle-btn active" onclick="selectToken('XRP')">
                            <span>XRP</span>
                        </button>
                        <button class="token-toggle-btn" onclick="selectToken('RLUSD')">
                            <span>RLUSD</span>
                        </button>
                    </div>
                    
                    <div class="tip-form-group">
                        <label class="tip-form-label">Recipient Address</label>
                        <input type="text" class="tip-input" id="recipient" placeholder="0x...">
                    </div>
                    
                    <div class="tip-form-group">
                        <label class="tip-form-label">Amount</label>
                        <input type="number" class="tip-input" id="amount" placeholder="0.0" step="0.01">
                    </div>
                    
                    <div class="quick-amounts">
                        <button class="quick-amount-btn" onclick="setAmount(0.1)">0.1</button>
                        <button class="quick-amount-btn" onclick="setAmount(0.5)">0.5</button>
                        <button class="quick-amount-btn" onclick="setAmount(1)">1</button>
                        <button class="quick-amount-btn" onclick="setAmount(5)">5</button>
                    </div>
                    
                    <div class="tip-form-group">
                        <label class="tip-form-label">Message (optional)</label>
                        <input type="text" class="tip-input" id="message" placeholder="Thanks for the great work!">
                    </div>
                    
                    <button class="btn btn-primary" style="width: 100%;" id="tipBtn" onclick="sendTip()">
                        <i data-lucide="coins"></i>
                        Send Tip
                    </button>
                </div>
                
                <!-- Leaderboard -->
                <div class="xavi-card tip-card">
                    <h3 class="tip-card-title">
                        <i data-lucide="trophy" style="width: 20px; stroke: var(--xavi-gold);"></i>
                        Top Tippers
                    </h3>
                    
                    <div id="leaderboard">
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank gold">1</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-address">0x963D...d700</div>
                                <div class="leaderboard-tips">12 tips sent</div>
                            </div>
                            <div class="leaderboard-amount">25.5 XRP</div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank silver">2</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-address">0x51A8...B2F1</div>
                                <div class="leaderboard-tips">8 tips sent</div>
                            </div>
                            <div class="leaderboard-amount">18.2 XRP</div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank bronze">3</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-address">0xABc3...9D44</div>
                                <div class="leaderboard-tips">5 tips sent</div>
                            </div>
                            <div class="leaderboard-amount">10.0 XRP</div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank default">4</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-address">0xF827...1E90</div>
                                <div class="leaderboard-tips">3 tips sent</div>
                            </div>
                            <div class="leaderboard-amount">5.5 XRP</div>
                        </div>
                        <div class="leaderboard-item">
                            <div class="leaderboard-rank default">5</div>
                            <div class="leaderboard-info">
                                <div class="leaderboard-address">0x2D19...8AF3</div>
                                <div class="leaderboard-tips">2 tips sent</div>
                            </div>
                            <div class="leaderboard-amount">2.0 XRP</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Stats -->
            <div class="tip-stats">
                <div class="xavi-card-flat tip-stat">
                    <div class="tip-stat-value">61.2 XRP</div>
                    <div class="tip-stat-label">Total Tips</div>
                </div>
                <div class="xavi-card-flat tip-stat">
                    <div class="tip-stat-value">30</div>
                    <div class="tip-stat-label">Tips Sent</div>
                </div>
                <div class="xavi-card-flat tip-stat">
                    <div class="tip-stat-value">12</div>
                    <div class="tip-stat-label">Unique Tippers</div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Toast -->
    <div class="toast" id="toast">
        <i data-lucide="check-circle"></i>
        <span id="toastMsg">Success!</span>
    </div>

    <script>
        lucide.createIcons();
        
        const TIPJAR = '0x0bff02033289A9F0fAb1980a4fd6Ba723e47Fdd4';
        const RLUSD = '0x6B906eaf5858c2b7F7D4C77eCb4112745B38afEb';
        
        let provider, signer, userAddress;
        let selectedToken = 'XRP';
        
        async function connectWallet() {
            if (!window.ethereum) {
                showToast('Please install MetaMask', 'error');
                return;
            }
            try {
                await window.ethereum.request({ method: 'eth_requestAccounts' });
                provider = new ethers.BrowserProvider(window.ethereum);
                signer = await provider.getSigner();
                userAddress = await signer.getAddress();
                
                document.getElementById('connectBtn').innerHTML = `<i data-lucide="wallet"></i>${userAddress.slice(0,6)}...${userAddress.slice(-4)}`;
                lucide.createIcons();
                showToast('Wallet connected!');
            } catch (e) {
                showToast(e.message, 'error');
            }
        }
        
        function selectToken(token) {
            selectedToken = token;
            document.querySelectorAll('.token-toggle-btn').forEach(b => {
                b.classList.toggle('active', b.textContent.trim() === token);
            });
        }
        
        function setAmount(val) {
            document.getElementById('amount').value = val;
        }
        
        async function sendTip() {
            if (!userAddress) {
                connectWallet();
                return;
            }
            
            const recipient = document.getElementById('recipient').value;
            const amount = document.getElementById('amount').value;
            const message = document.getElementById('message').value;
            
            if (!recipient || !amount) {
                showToast('Fill in recipient and amount', 'error');
                return;
            }
            
            showToast('Tip functionality coming soon!');
        }
        
        function copyText(text) {
            navigator.clipboard.writeText(text);
            showToast('Copied!');
        }
        
        function showToast(msg, type = 'success') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').textContent = msg;
            toast.className = `toast ${type} show`;
            setTimeout(() => toast.classList.remove('show'), 2500);
        }
    </script>
</body>
</html>
